---
layout: post
author: maxwei
title:  "2018 华为软件精英挑战赛总结(2)"
date:   2018-10-25 22:29:08 +0800
categories: 比赛
mathjax: true
---

时间序列预测-ARMA-model

<!--more-->

## ARMA模型

AR(Auto Regression)自回归模型，是一种线性预测模型。用同一变量之前若干时刻的数据来预测现在或未来时刻的数据。这种预测方法只与变量自己有关，而与其他变量无关，所以称作是自回归。

$$X_t = c + \sum_{i=1}^p \phi_iX_{t-i} + \epsilon_t$$



MA(Moving average)移动平均模型，移动平均模型描述的是自回归部分的误差累计。$\mu$为序列的均值。

$$X_t = \mu + \epsilon_t + \sum_{i=1}^p \theta_i\epsilon_{t-i}$$

如果某个观察序列可以通过序列预处理判定为平稳非白噪声序列，就可以利用ARMA模型进行建模。利用ARMA模型进行建模的步骤如下：

* 求出序列的自相关系数(ACF)和偏自相关系数(PACF)。
    1. 若PACF序列满足在p步截尾，且ACF序列被负指数函数控制收敛到0，则Yn为AR(p)序列。 
    2. 若ACF序列满足在q步截尾，且PACF序列被负指数函数控制收敛到0，则Yn为MA(q)序列。 
    3. 若ACF序列和PACF序列满足皆不截尾，但都被负指数函数控制收敛到0，则Yn为ARMA序列。
* 根据样本自身相关系数和偏自相关系数选择适当的阶数p,q
* 如果ACF和PACF都不能收敛，则对原序列做差分，将差分后的序列再做相关分析，知道满足条件。差分以后得到的预测值也为差值，需要还原为原始值。
* 估计模型中未知参数的值，可以用最小二乘估计，求解Yule-Walker方程，burge法
* 基于AIC,BIC,或HPIC准则判断模型的好坏。组合了模型预测结果与模型复杂度，防止过拟合。选择出最佳的阶数及其对应的系数。

在确定模型阶数的时候还有一种时间复杂度比较高的方法，设置一个初始的阶数的上限，可以是待估计序列的长度的线性关系，然后递减遍历每种阶数下对应的AIC,BIC,或HPIC的值，选择最小值对应的阶数。

## 最小二乘法求AR模型系数

由p阶的AR(p)方程可以得到预测值为${y[p],y[p+1],...,y[N]}$,可以写成Ｎ个线性方程组：

$$
y[N] = \sum_{i=1}^p a[i]*x[N-i]
$$

写成矩阵的形式为：

$$Y[N-p,1] = X[N-p,p]*A[p,1] $$

根据最小二乘的原则，得到参数的计算公式为：

$$A=(X^TX)^{-1}X^TY$$




